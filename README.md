<html>
<head>
<script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_CHTML"></script>
</head>	
<body>
# Multi-peg Tower of Hanoi

We consider **Stewart's algorihm** for solving the **multi-peg Hanoi Tower problem**.

## Algorithm

Stewart's algorithm solves the p-peg n-disc from source to destination as follows:

- choose a height <img src="https://raw.githubusercontent.com/brunoscherrer/multipegtowerofhanoi/master/svgs/63e69e544b11c8bcd7169f4557a17863.svg?invert_in_darkmode" align=middle width=114.46083pt height=22.83138pt/> (see below) ;
- move the <img src="https://raw.githubusercontent.com/brunoscherrer/multipegtowerofhanoi/master/svgs/fc0695d139dc2d486dbfe6abf8b0340e.svg?invert_in_darkmode" align=middle width=52.214745pt height=24.6576pt/>-high upper part of the tower to any peg different from source and destination, say number peg <img src="https://raw.githubusercontent.com/brunoscherrer/multipegtowerofhanoi/master/svgs/77a3b857d53fb44e33b53e4c8b68351a.svg?invert_in_darkmode" align=middle width=5.663295pt height=21.68331pt/> ;
- move the <img src="https://raw.githubusercontent.com/brunoscherrer/multipegtowerofhanoi/master/svgs/2ad9d098b937e46f9f58968551adac57.svg?invert_in_darkmode" align=middle width=9.471165pt height=22.83138pt/>-high lower part from source to destination using all pegs except <img src="https://raw.githubusercontent.com/brunoscherrer/multipegtowerofhanoi/master/svgs/77a3b857d53fb44e33b53e4c8b68351a.svg?invert_in_darkmode" align=middle width=5.663295pt height=21.68331pt/> ;
- move the <img src="https://raw.githubusercontent.com/brunoscherrer/multipegtowerofhanoi/master/svgs/fc0695d139dc2d486dbfe6abf8b0340e.svg?invert_in_darkmode" align=middle width=52.214745pt height=24.6576pt/> from <img src="https://raw.githubusercontent.com/brunoscherrer/multipegtowerofhanoi/master/svgs/77a3b857d53fb44e33b53e4c8b68351a.svg?invert_in_darkmode" align=middle width=5.663295pt height=21.68331pt/> to destination.

See [below](#anim) for an illustration of this algorithm for n=10 discs.

## (Short) analysis

The number of steps <img src="https://raw.githubusercontent.com/brunoscherrer/multipegtowerofhanoi/master/svgs/871b1970b5c0856a808bf55bf945d65d.svg?invert_in_darkmode" align=middle width=49.25613pt height=24.6576pt/> to solve the p-peg n-disc problem satisfies the recurrence relation:

<img src="https://raw.githubusercontent.com/brunoscherrer/multipegtowerofhanoi/master/svgs/3ca362e1c8aba57ee6158644d5c68161.svg?invert_in_darkmode" align=middle width=431.898555pt height=24.6576pt/> <br>
with <img src="https://raw.githubusercontent.com/brunoscherrer/multipegtowerofhanoi/master/svgs/8296ec3ea4a7d9ff0544ab37d62c46a3.svg?invert_in_darkmode" align=middle width=77.694045pt height=24.6576pt/> and <img src="https://raw.githubusercontent.com/brunoscherrer/multipegtowerofhanoi/master/svgs/c594feb0a875846167462e62c89d095a.svg?invert_in_darkmode" align=middle width=87.56088pt height=24.6576pt/> for all <img src="https://raw.githubusercontent.com/brunoscherrer/multipegtowerofhanoi/master/svgs/0aff5817ce8bca3361dd53d702450634.svg?invert_in_darkmode" align=middle width=44.569965pt height=21.18732pt/>

For any <img src="https://raw.githubusercontent.com/brunoscherrer/multipegtowerofhanoi/master/svgs/4a7904636f1a65178b5330484196fa32.svg?invert_in_darkmode" align=middle width=38.22885pt height=24.6576pt/>, an optimal choice is any element of the argmin set <img src="https://raw.githubusercontent.com/brunoscherrer/multipegtowerofhanoi/master/svgs/5f7ac9a9c839c8f9190dc5ee3e558ddb.svg?invert_in_darkmode" align=middle width=47.700015pt height=24.6576pt/>.
The number of paths <img src="https://raw.githubusercontent.com/brunoscherrer/multipegtowerofhanoi/master/svgs/8e73e453a97fff6cbf5eeabbd78d49e4.svg?invert_in_darkmode" align=middle width=53.228835pt height=24.6576pt/> that can generated by the algorithm satisfies the following recurrence:

<img src="https://raw.githubusercontent.com/brunoscherrer/multipegtowerofhanoi/master/svgs/1df215319f37778c2d2e933b7a520dc3.svg?invert_in_darkmode" align=middle width=337.982205pt height=24.65793pt/> <br>
with <img src="https://raw.githubusercontent.com/brunoscherrer/multipegtowerofhanoi/master/svgs/609eb0a296db18064b5d4f5952c80693.svg?invert_in_darkmode" align=middle width=83.36559pt height=24.6576pt/> if <img src="https://raw.githubusercontent.com/brunoscherrer/multipegtowerofhanoi/master/svgs/64a663a38abcc84dacb4a6eaf1033306.svg?invert_in_darkmode" align=middle width=40.05507pt height=17.72397pt/> or <img src="https://raw.githubusercontent.com/brunoscherrer/multipegtowerofhanoi/master/svgs/333609c964d3d78f55dc02ff5b8831af.svg?invert_in_darkmode" align=middle width=38.407545pt height=21.18732pt/>.

Below are some empirical curves of the above quantities.

- p=3

![](p=3.png)

- p=4

![](p=4.png)

- p=5

![](p=5.png)

- p=6

![](p=6.png)

- p=7

![](p=7.png)

- p=8

![](p=8.png)

- p=9

![](p=9.png)




## Graphical illustration of the algorithm <a name="anim"></a>

- 3 pegs:

![](10_3.gif)

- 4 pegs:

![](10_4.gif)

- 5 pegs:

![](10_5.gif)

- 6 pegs:

![](10_6.gif)

## References

Sandi Klavžar, Uroš Milutinović, Ciril Petr. *On the Frame–Stewart algorithm for the multi-peg Tower of Hanoi problem.* Discrete Applied Mathematics. Volume 120, Issues 1–3, 15 August 2002, Pages 141-157.<br>
Thierry Bousch. *La quatrième tour de Hanoï.* Bull. Belg. Math. Soc. Simon Stevin Volume 21, Number 5 (2014), 895-912.<br>

</body>
</html>
